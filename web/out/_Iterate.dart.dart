// Auto-generated from Iterate.html.
// DO NOT EDIT.

library Iterate_html;

import 'dart:html' as autogenerated;
import 'package:web_components/web_components.dart' as autogenerated;

import 'dart:html';


// Original code
List<String> features = const <String>['lexical scope',
                                        'closures',
                                        'getters and setters',
                                        'isolates',
                                        'top-level functions',
                                        'optional static types',
                                        'one-line functions',
                                        'familiar syntax',
                                        'map and list literals',
                                        'generics'];

List<String> userFavorites = new List<String>();  // TODO use a Set when it can be watched

addToFavorites(Event e) {
  InputElement checkbox = e.target;
  String fav = checkbox.value;
  int index = userFavorites.indexOf(fav);
  
  if (checkbox.checked && index < 0) {
    userFavorites.add(fav);
  } else if (!checkbox.checked && index >= 0) {
    userFavorites.removeAt(index);
  }
  
  userFavorites.sort();
}

main() { }

// Additional generated code
/** Create the views and bind them to models. */
void init_autogenerated() {
  // Create view.
  var _root = new autogenerated.DocumentFragment.html(_INITIAL_PAGE);

  autogenerated.UnknownElement __e3;
  
  List<autogenerated.WatcherDisposer> _stoppers1;
  
  List<Function> _removeChild__e3 = [];
  
  autogenerated.Node _endPosition__e3;
  
  autogenerated.UnknownElement __e6;
  
  List<Function> _removeChild__e6 = [];
  
  autogenerated.Node _endPosition__e6;
  


  // Initialize fields.
  __e3 = _root.query('#__e-3');
  _stoppers1 = [];
  __e6 = _root.query('#__e-6');
  

  // Attach model to views.
  _endPosition__e3 = __e3;
  
  _stoppers1.add(autogenerated.watchAndInvoke(() => features, (_) {
    for (var remover in _removeChild__e3) remover();
    _removeChild__e3.clear();
    
    _endPosition__e3 = autogenerated.removeNodes(__e3, _endPosition__e3);
    
    var __insert___e3 = __e3.nextNode;
    
    for (var feature in features) {
      
      autogenerated.InputElement __e0;
      autogenerated.EventListener _listener__e0_click_2_1;
      List<autogenerated.WatcherDisposer> _stoppers3_2;
      autogenerated.SpanElement __e2;
      var _binding1;
      
      __e0 = __e3.query('#__e-0');
      _stoppers3_2 = [];
      __e2 = __e3.query('#__e-2');
      _binding1 = autogenerated.nodeForBinding( feature );
      __e2.nodes.add(_binding1);
      
      autogenerated.insertAllBefore(__e3.parent, __insert___e3,
      
      [_endPosition__e3 = new autogenerated.Element.html('<li><input type="checkbox" id="__e-0"> <span id="__e-2"></span></li>')]);
      
      _listener__e0_click_2_1 = (__e) {
        addToFavorites(__e);
        autogenerated.dispatch();
      };
      __e0.on.click.add(_listener__e0_click_2_1);
      
      _stoppers3_2.add(autogenerated.watchAndInvoke(() =>  feature , (__e) { __e0.value = __e.newValue; }));
      _stoppers3_2.add(autogenerated.watchAndInvoke(() =>  feature , (__e) { _binding1 = autogenerated.updateBinding(__e.newValue, _binding1); }));
      
      _removeChild__e3.add(() {
        
        (_stoppers3_2..forEach((s) => s())).clear();
        __e0.on.click.remove(_listener__e0_click_2_1);
        _listener__e0_click_2_1 = null;
        
        __e0 = null;
        __e2 = null;
        _binding1 = null;
        
      });
    }
  }));
  
  _endPosition__e6 = __e6;
  
  _stoppers1.add(autogenerated.watchAndInvoke(() => userFavorites, (_) {
    for (var remover in _removeChild__e6) remover();
    _removeChild__e6.clear();
    
    _endPosition__e6 = autogenerated.removeNodes(__e6, _endPosition__e6);
    
    var __insert___e6 = __e6.nextNode;
    
    for (var fav in userFavorites) {
      
      autogenerated.SpanElement __e5;
      var _binding4;
      List<autogenerated.WatcherDisposer> _stoppers4_1;
      
      __e5 = __e6.query('#__e-5');
      _binding4 = autogenerated.nodeForBinding( fav );
      _stoppers4_1 = [];
      __e5.nodes.add(_binding4);
      
      autogenerated.insertAllBefore(__e6.parent, __insert___e6,
      
      [_endPosition__e6 = new autogenerated.Element.html('<li><span id="__e-5"></span></li>')]);
      
      _stoppers4_1.add(autogenerated.watchAndInvoke(() =>  fav , (__e) { _binding4 = autogenerated.updateBinding(__e.newValue, _binding4); }));
      
      _removeChild__e6.add(() {
        
        __e5 = null;
        (_stoppers4_1..forEach((s) => s())).clear();
        _binding4 = null;
        
      });
    }
  }));
  


  // Attach view to the document.
  autogenerated.document.body.nodes.add(_root);
  _root = autogenerated.document.body;
}

final String _INITIAL_PAGE = '''

    <h1>Hello MDV: Iteration</h1>
    
    <h2>Language features</h2>
    
    <h3>Dart</h3>
      
    <ul>
      <template id="__e-3" style="display:none"></template>
    </ul>
    
    <h3>Your favorite features</h3>
    
    <ul>
      <template id="__e-6" style="display:none"></template>
    </ul>
    
    
    <script src="../dart.js"></script>
  
''';
